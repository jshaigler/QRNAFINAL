# Publishing Guide for @rnafoldquantum/wasm-client

## Prerequisites

1. **npm account** - Create one at https://www.npmjs.com/signup if you don't have one

## Step-by-Step Publishing Instructions

### 1. Login to npm

```bash
npm login
```

You'll be prompted for:
- Username
- Password
- Email
- One-time password (if you have 2FA enabled)

### 2. Navigate to the package directory

```bash
cd RnaFoldQuantum/rna-fold-quantum-client2
```

### 3. Verify everything is built

```bash
npm run build
```

This will compile TypeScript and copy Python modules to the `dist/` folder.

### 4. Test the package locally (optional but recommended)

```bash
node test-simple.js
```

### 5. Publish the package

Since this is a **scoped package** (`@rnafoldquantum/...`), you need to make it public:

```bash
npm publish --access public
```

**Without `--access public`, scoped packages default to private (which requires a paid npm account).**

### 6. Verify publication

After publishing, check your package at:
```
https://www.npmjs.com/package/@rnafoldquantum/wasm-client
```

## Complete Command Sequence

```bash
# Login (only needed once)
npm login

# Navigate to package
cd RnaFoldQuantum/rna-fold-quantum-client2

# Build
npm run build

# Publish
npm publish --access public
```

## Testing After Publication

Create a new test project:

```bash
mkdir test-package
cd test-package
npm init -y
npm install @rnafoldquantum/wasm-client
```

Create `test.js`:
```javascript
const { RnaFoldQuantumClient } = require('@rnafoldquantum/wasm-client');

async function test() {
    const client = new RnaFoldQuantumClient();
    await client.initialize();
    const result = await client.predictStructure('GGGAAACCC');
    console.log(result);
}

test();
```

Run it:
```bash
node test.js
```

## Publishing Updates

When you make changes and want to publish a new version:

### 1. Update the version number

```bash
npm version patch   # 1.0.0 -> 1.0.1 (bug fixes)
npm version minor   # 1.0.0 -> 1.1.0 (new features)
npm version major   # 1.0.0 -> 2.0.0 (breaking changes)
```

This automatically updates `package.json` and creates a git tag.

### 2. Publish the update

```bash
npm publish --access public
```

## Troubleshooting

### "You must be logged in to publish packages"
```bash
npm login
```

### "You do not have permission to publish"
- Make sure you're logged in with the correct account
- Check that the package name isn't already taken
- For scoped packages, use `--access public`

### "Cannot publish over existing version"
- Update the version in `package.json` or use `npm version patch`

### "Package name too similar to existing package"
- Choose a different package name

## Unpublishing (if needed)

⚠️ **Warning**: Unpublishing is permanent and affects all users!

```bash
# Unpublish a specific version (within 72 hours of publishing)
npm unpublish @rnafoldquantum/wasm-client@1.0.0

# Unpublish entire package (within 72 hours of publishing)
npm unpublish @rnafoldquantum/wasm-client --force
```

**After 72 hours**, you can only deprecate:
```bash
npm deprecate @rnafoldquantum/wasm-client@1.0.0 "Reason for deprecation"
```

## Best Practices

1. **Test before publishing** - Always run tests locally
2. **Use semantic versioning** - Follow semver (major.minor.patch)
3. **Document changes** - Keep a CHANGELOG.md
4. **Check `.npmignore`** - Don't publish unnecessary files
5. **Review package contents** - Use `npm pack` to see what will be published

## What Gets Published

The package includes:
- `dist/` - Compiled JavaScript and TypeScript definitions
- `dist/python-modules/` - Python RNA folding code
- `package.json` - Package metadata
- `README.md` - Documentation

Files/folders **not** published (automatically ignored):
- `node_modules/`
- `src/` - TypeScript source (only compiled `dist/` is published)
- `.git/`
- `test-simple.js`
- `.gitignore`

## Quick Reference

```bash
# Login
npm login

# Build
npm run build

# Publish
npm publish --access public

# Update version
npm version patch

# Republish after update
npm publish --access public
```

That's it! Your package will be available on npm for anyone to install with:
```bash
npm install @rnafoldquantum/wasm-client
```
